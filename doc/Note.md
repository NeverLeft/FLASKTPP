## 淘票票
- 项目分析
    - 用户端
        - 地址列表以及选取
        - 电影列表
            - 正在热映
            - 即将上映
        - 影院列表
            - 根据区域筛选
            - 根据评分等进行排序
        - 观影信息
        - 买票，下单
        
    - 商家端
        - 电影院
        - 电影播放权
        - 排挡

#### 功能实现
- 地址



##### 地址功能
- 地址数据获取
    - 通过网络抓包
    - 爬虫会继续学抓包
        - fildder
        - charlas
        - httpwatch
    - 数据抓到之后，写脚本转换到数据库中
        - 读数据
            - 读成字符串，转换成json
        - 写入到数据库
            - 遍历json数据，写入数据库
            - 数据库连接
                - client
            - 字符编码
            - 操作数据
                - cursor
                - 游标
                - 也是我们执行sql入口
                - 也是数据的容器
                - 记得commit
- 地址数据展示
    - 第一块把数据从数据库中取出
        - 查询
        - 模型.query.filter.all
    - 把数据格式化成预期的状态
        - 定制marshal_with中的 result_fields
        - 如果动态的
            - 可以动态生成格式化
            - 使用marshal
            
#### 订单
- 买票订单
- 用户已经登录


#### 装饰器
- 在不修改的代码的情况下，添加一些逻辑
- 计时装饰器
    - 直接定义了一个函数
    - 函数的参数是一个fun（还是一个函数）
    - 直接可以时间计时
    - 不能处理带参数的函数计时
- 处理带参数的函数装饰器
    - 在内部的函数中，添加了参数列表 *args, **kwargs 
- 就可以接收参数，处理业务逻辑


#### 装饰器使用
- 实现了用户状态预校验
- @login_required
    - 装饰器内部判断，验证用户令牌是否存在
    - 如果针对有有返回的 函数，需要将函数再次进行返回。
    
#### 下单
- 核心数据就是用户和电影院排挡
- 用户是咱们自己的，可以直接使用的
- 排挡是电影院产生的
    - 电影院根据电影和大厅拍出来的
- 下单的时候，还需要确定电影，电影时间，和电影票的位置
    - 电影在排挡中存在，时间在排挡中存在
    - 电影票的位置，需要通过排挡获取到大厅
    - 大厅要根据自己的类型，获取到座位样式
- 下单
    - 生成一个订单
    - 导数据，将选座的数据，转换到票的数据中
- 订单锁定
            

#### 异步消息队列
- 做耗时操作
- 页面不需要立刻返回结果的
- 复杂运算
- 论文查重

#### Celery
- 结合Flask的时候
    - 如果没有进行复杂拆分的时候，和app = Flask在一个路径中
    - 如果进行了定制的拆分，需要和启动入口 manage.py 在一个路径中
- 结合Django
    - Django重量级框架，配置略微麻烦
    - 直接将对应的配置，粘贴到你的项目中
         - 基本不用修改，修改工程路径，工程名字等对应的信息
         
#### Flask项目部署
- 和django基本一致
- 开发的时候，都是使用的开发者服务器
- 在线上部署的时候，都会做动静分离
    - 静态资源交给Nginx来进行处理
    - 动态资源，使用uwsgi服务器进行处理
        - Nginx将请求转发给uwsgi


##### homework
- 搞定Flask文件上传Flask-Uploads